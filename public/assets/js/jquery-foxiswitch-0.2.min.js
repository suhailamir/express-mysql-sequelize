/**
 * name:          jquery-foxiswitch-0.2.min.js
 * author:        Stefan Benicke - www.opusonline.at
 * version:       0.2
 * last update:   01.10.2009
 * category:      jQuery plugin
 * copyright:     (c) 2009 Stefan Benicke (www.opusonline.at)
 * license:       GNU GPLv3 <http://www.gnu.org/licenses/>
 * documentation: http://www.opusonline.at/foxitools/foxiswitch/
 */
(function(a){a.fn.foxiswitch=function(h){h=jQuery.extend({fade:0.3,speed:500,caption:true,externalImages:false,thumbWidth:50,slideSpeed:5000,autoplay:false,textPrev:"",textNext:"",textPlay:"",textHelp:"",helptext:"",imageBeforeCaption:true,thumbsBeforeControls:true,imageBeforeThumbs:true},h);var l=a(this);var m=false;l.find("li:first").addClass("first").addClass("active");l.find("li:last").addClass("last");var j=true;if(a.browser.msie){if(a.browser.version<=6){j=false}}var f='<div id="foxiswitch_container">';var i='<div id="foxiswitch_image"><img id="foxiswitch_image_old" /><img id="foxiswitch_image_new" /></div>';if(h.imageBeforeCaption){f+=i}if(h.caption){f+='<div id="foxiswitch_caption"></div>'}if(!h.imageBeforeCaption){f+=i}f+='<div id="foxiswitch_helptext" style="display:none">'+h.helptext+"</div></div>";(h.imageBeforeThumbs)?l.before(f):l.after(f);var e='<div id="foxiswitch_controls"><span id="foxiswitch_prev">'+h.textPrev+'</span> <span id="foxiswitch_next">'+h.textNext+'</span><span id="foxiswitch_slideshow">'+h.textPlay+'</span> <span id="foxiswitch_help">'+h.textHelp+"</span></div>";(h.thumbsBeforeControls)?l.after(e):l.before(e);a(document).keydown(function(o){switch(o.keyCode){case 37:d();return false;break;case 39:g();return false;break;case 32:(m)?b():c();return false;break;case 38:if(m){if(h.slideSpeed>=500){h.slideSpeed-=500}a("#foxiswitch_slideshow").text(h.textStop+" ("+(h.slideSpeed/1000)+" sec.)");return false}break;case 40:if(m){h.slideSpeed+=500;a("#foxiswitch_slideshow").text(h.textStop+" ("+(h.slideSpeed/1000)+" sec.)");return false}break}});a("#foxiswitch_prev").bind("click",function(){if(m){b()}d()});a("#foxiswitch_next").bind("click",function(){if(m){b()}g()});a("#foxiswitch_slideshow").bind("click",function(){(m)?b():c()});a("#foxiswitch_help").hover(function(){(j)?a("#foxiswitch_helptext").fadeIn(h.speed):a("#foxiswitch_helptext").show()},function(){(j)?a("#foxiswitch_helptext").fadeOut(h.speed):a("#foxiswitch_helptext").hide()});l.find("li").each(function(){a(this).find("img").each(function(){if(!h.externalImages){var o=(a(this).width()/a(this).height());a(this).width(h.thumbWidth);a(this).height(Math.round(h.thumbWidth/o))}}).bind("mouseenter",function(){if(j){a(this).fadeTo(h.speed,1)}}).bind("mouseleave",function(){if(j){a(this).parents("li").not(".active").find("img").fadeTo(h.speed,h.fade)}}).bind("click",function(){if(m){b()}if(j){l.find("li.active img").fadeTo(h.speed,h.fade)}l.find("li.active").removeClass("active");a(this).parents("li").addClass("active");n(a(this).parents("li"))});if(j){a(this).find("img").fadeTo(h.speed,h.fade)}a(this).find("span").hide();a(this).find("a").bind("click",function(){return false})});if(j){l.find("li.active img").fadeTo(h.speed,1)}if(h.autoplay){m=true;a("#foxiswitch_slideshow").text(h.textStop)}n(l.find("li.active"));function n(p){var o=new Image();o.onload=function(){var q=o.width;var r=o.height;if(j){a("#foxiswitch_image_new").css("z-index",0).fadeOut(1,function(){a(this).attr("src",o.src).width(q).height(r).fadeIn(h.speed)});a("#foxiswitch_image_old").css("z-index",1).fadeOut(h.speed,function(){if(h.caption){a("#foxiswitch_caption").fadeOut(1,function(){a(this).html(p.find("span").html()).fadeIn(h.speed)})}a("#foxiswitch_image_new").css("z-index",1);a("#foxiswitch_image_old").css("z-index",0).attr("src",o.src).width(q).height(r).fadeIn(1)})}else{a("#foxiswitch_image_new").attr("src",o.src).width(o.width).height(o.height);if(h.caption){a("#foxiswitch_caption").html(p.find("span").html())}}if(m){k()}};o.src=(h.externalImages)?p.find("a").attr("href"):p.find("img").attr("src")}function d(){if(j){l.find("li.active img").fadeTo(h.speed,h.fade)}if(l.find("li.active").hasClass("first")){l.find("li.active").removeClass("active");l.find("li.last").addClass("active")}else{l.find("li.active").removeClass("active").prev().addClass("active")}if(j){l.find("li.active img").fadeTo(h.speed,1)}n(l.find("li.active"))}function g(){if(j){l.find("li.active img").fadeTo(h.speed,h.fade)}if(l.find("li.active").hasClass("last")){l.find("li.active").removeClass("active");l.find("li.first").addClass("active")}else{l.find("li.active").removeClass("active").next().addClass("active")}if(j){l.find("li.active img").fadeTo(h.speed,1)}n(l.find("li.active"))}function c(){m=true;a("#foxiswitch_slideshow").text(h.textStop+" ("+(h.slideSpeed/1000)+" sec.)");k()}function b(){m=false;a("#foxiswitch_slideshow").text(h.textPlay);l.stop()}function k(){l.animate({top:0},h.slideSpeed,function(){g()})}}})(jQuery);
